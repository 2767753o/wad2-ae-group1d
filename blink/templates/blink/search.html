{% extends 'blink/base.html' %}
{% load static %}

{% block title_block %}
    Feed
{% endblock %}

{% block body_block %}
    <section id="feed">
        {% comment %} SEARCH RESULTS {% endcomment %}
        <h1>Search results for: <em>{{ query }}</em></h1>
        
        {% comment %} POST RESULTS {% endcomment %}
        <div>
            {% if post_results %}
                {% for post in post_results %}
                    <div>
                        <section id="postTop">
                            <a href="{% url 'blink:user' post.user.username %}">
                                {% if post.user.profilePicture %}
                                    <img src="{{ post.user.profilePicture.url }}" alt="Profile Picture" width="75" height="75" />
                                {% else %}
                                    <img src="{% static 'images/defaultPFP.png' %}" alt="Profile Picture" width="75" height="75" />
                                {% endif %}
                            </a>
                            <a href="{% url 'blink:user' post.user.username %}">{{ post.user }}</a>
                            <p>{{ post.releaseDate }}</p>
                        </section>
                        <section id="postContent">
                            {% if post.image %}
                                <img src="{{ post.image.url }}" alt="Post Image">
                            {% endif %}
                            <p>{{ post.content }}</p>
                        </section>
                        <section id="postBottom">
                            <div>
                                {% comment %} LIKE LOGIC {% endcomment %}
                                <button class="like_button" id="like_button_{{ post.postID }}_post" data-postid="{{ post.postID }}" type="button">
                                    {% if post.2 %}
                                        <img src="{% static 'images/icons/likeFilled.svg' %}" alt="Like"/>
                                    {% else %}
                                        <img src="{% static 'images/icons/likeEmpty.svg' %}" alt="Like"/>
                                    {% endif %}
                                </button>
                                <a href="{% url 'blink:view_likes_post' post.postID %}">
                                    <strong class="like_count" id="like_count_{{ post.postID }}_post">{{ post.1 }}
                                        {% if post.1 == 1 %}
                                            like
                                        {% else %}
                                            likes
                                        {% endif %}
                                    </strong>
                                </a>
                            </div>
                                <a href="{% url 'blink:view_post' post.postID %}">
                                    <button>
                                        <img src="{% static 'images/icons/comment.svg' %}" alt="Comment"/>
                                    </button>
                                </a>
                        </section>
                    </div>
                {% endfor %}
            {% elif user_data %}
                {% for user in user_data %}
                    <div>
                        <h2>Users: </h2>
                        <section id="userFind">
                            {% if user.1.profilePicture %}
                                <img src="{{ user.1.profilePicture.url }}" alt="Profile Picture" width="75" height="75" />
                            {% else %}
                                <img src="{% static 'images/defaultPFP.png' %}" alt="Profile Picture" width="75" height="75" />
                            {% endif %}
                            <br /><a href="{% url 'blink:user' user.0.username %}">{{ user.0.username }}</a>
                        </section>
                    </div>
                {% endfor %}
            {% endif %}
            {% if not user_data and not post_results %}
                <div>
                    <h2>No posts or Users found.</h2>
                </div>
            {% endif %}
        </div> 
    </section>
{% endblock %}
